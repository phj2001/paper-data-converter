# 纸质数据转换工具 - 图形界面版本

## 版本说明

GUI版本提供了美观、易用的图形界面，无需命令行操作，所有配置和交互都在界面中完成。

---

## 安装依赖

首次运行前，请安装GUI所需的额外依赖：

```bash
pip install customtkinter Pillow
```

或使用项目提供的依赖文件：

```bash
pip install -r requirements.txt
```

---

## 启动程序

### 方法1：直接运行（推荐）

双击运行 `启动GUI.bat` 文件（Windows）

### 方法2：命令行运行

```bash
python gui_app.py
```

---

## 界面功能说明

### 主界面布局

```
┌─────────────────────────────────────────────────────────┐
│           纸质数据转换工具                                │
│     V3.0 - 智能OCR识别 · 统一列结构 · 高精度提取          │
├──────────────────────┬──────────────────────────────────┤
│                      │                                  │
│  【配置选项】         │  【处理日志】                    │
│                      │                                  │
│  图片文件夹: [___]   │  [日志输出区域]                  │
│  [浏览]              │                                  │
│                      │  ▓▓▓▓▓▓▓▓▓▓▓▓  进度条            │
│  输出文件名: [___]   │                                  │
│                      │  状态: 就绪                       │
│  数据列数: [___]     │                                  │
│                      │                                  │
│  [配置列标题]        │                                  │
│                      │                                  │
│  [列标题预览]        │                                  │
│                      │                                  │
│  待处理文件: X 张    │                                  │
│                      │                                  │
├──────────────────────┴──────────────────────────────────┤
│                                                       │
│              [  开始转换  ]                            │
│                                                       │
└─────────────────────────────────────────────────────────┘
```

---

## 使用步骤

### 1. 选择图片文件夹

点击 **"浏览"** 按钮，选择包含待处理图片的文件夹。

选择后，界面会显示找到的图片数量。

**支持的图片格式：**
- JPG / JPEG
- PNG
- BMP
- WebP

### 2. 设置输出文件名

输入Excel输出文件的名称（默认：`output_data.xlsx`）

### 3. 配置数据列数

输入表格的总列数（例如：4）

### 4. 配置列标题

点击 **"配置列标题"** 按钮，打开配置对话框：

```
┌────────────────────────────────┐
│  配置 4 列的标题               │
├────────────────────────────────┤
│                                │
│ 第 1 列: [_______________]     │
│ 第 2 列: [_______________]     │
│ 第 3 列: [_______________]     │
│ 第 4 列: [_______________]     │
│                                │
│                                │
│           [取消]  [保存]        │
│                                │
└────────────────────────────────┘
```

为每一列输入标题，例如：
- 第1列：序号
- 第2列：品名
- 第3列：数量
- 第4列：单位

配置完成后，点击 **"保存"**。

### 5. 预览列标题

在主界面的"列标题预览"区域查看配置的列标题：

```
列标题预览：

列 1: 序号
列 2: 品名
列 3: 数量
列 4: 单位
```

### 6. 开始转换

点击 **"开始转换"** 按钮，程序将：

1. 扫描文件夹中的所有图片
2. 逐个调用OCR API识别表格
3. 验证每张图片的列数是否符合配置
4. 将所有数据写入Excel文件
5. 实时显示处理日志和进度

---

## 处理过程

### 日志输出示例

```
==================================================
开始处理...
==================================================
找到 6 张图片
列数: 4
列标题: 序号, 品名, 数量, 单位
--------------------------------------------------
[1/6] 处理: 001.jpg
  [OK] 成功: 19 行
[2/6] 处理: 002.jpg
  [FAIL] 识别失败
[3/6] 处理: 003.jpg
  [OK] 成功: 19 行
...
==================================================
处理完成
==================================================
成功: 4 张
失败: 2 张
总计: 6 张

正在保存Excel文件...
[OK] 已保存到: output_data.xlsx
```

### 进度显示

- 进度条显示当前处理进度
- 状态标签显示详细状态信息
- 日志区域实时更新处理详情

---

## 输出结果

### Excel文件结构

生成的Excel文件包含：

| 列1 | 列2 | 列3 | 列4 | 图片名称 |
|-----|-----|-----|-----|----------|
| ... | ... | ... | ... | 001.jpg  |
| ... | ... | ... | ... | 001.jpg  |
| ... | ... | ... | ... | 003.jpg  |
| ... | ... | ... | ... | 003.jpg  |

**特点：**
- 所有数据在同一工作表中
- 最后一列为"图片名称"，标识数据来源
- 表头使用蓝色背景加粗显示
- 自动调整列宽
- 冻结首行

---

## 常见问题

### Q1: 程序无法启动？

**A:** 确保已安装所有依赖：
```bash
pip install -r requirements.txt
```

### Q2: 选择文件夹后没有显示图片数量？

**A:** 检查文件夹中是否包含支持的图片格式（JPG、PNG等）

### Q3: 点击"开始转换"后提示错误？

**A:** 常见原因：
- 未配置列标题（或列数不匹配）
- 文件夹不存在
- 输出文件名无效

### Q4: 某些图片识别失败？

**A:** 可能原因：
- API超时（网络问题）
- 图片质量过低
- 图片中不包含符合格式的表格

**解决方法：**
- 重新扫描或拍照
- 确保图片清晰
- 查看日志了解具体错误

### Q5: 可以处理不同列数的表格吗？

**A:** 不可以。GUI版本要求所有图片使用相同的列结构。如果需要处理不同结构的表格，请使用命令行版本的V2.0。

---

## 技术架构

### GUI框架

**CustomTkinter**
- 基于Tkinter的现代化UI库
- 支持深色/浅色主题
- 圆角设计、平滑动画
- 跨平台支持（Windows、macOS、Linux）

### 后台处理

- **多线程**：处理过程在后台线程运行，不阻塞UI
- **实时更新**：日志和进度实时显示
- **异常处理**：完整的错误捕获和提示

### 界面组件

| 组件 | 用途 |
|------|------|
| CTkFrame | 容器框架 |
| CTkLabel | 标签文本 |
| CTkEntry | 输入框 |
| CTkButton | 按钮 |
| CTkTextbox | 多行文本框 |
| CTkScrollbar | 滚动条 |
| CTkProgressBar | 进度条 |
| CTkToplevel | 对话框窗口 |
| CTkScrollableFrame | 可滚动框架 |

---

## 界面主题

### 切换外观模式

修改 `gui_app.py` 中的配置：

```python
# 浅色主题（默认）
ctk.set_appearance_mode("light")

# 深色主题
ctk.set_appearance_mode("dark")

# 跟随系统
ctk.set_appearance_mode("system")
```

### 切换配色方案

```python
# 蓝色主题（默认）
ctk.set_default_color_theme("blue")

# 绿色主题
ctk.set_default_color_theme("green")

# 深蓝色主题
ctk.set_default_color_theme("dark-blue")
```

---

## 快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl+O | 打开文件夹 |
| Enter | 开始转换 |
| Esc | 关闭对话框 |

---

## 系统要求

- **Python**: 3.8 或更高版本
- **操作系统**: Windows 7+, macOS 10.14+, Linux
- **内存**: 最低 2GB RAM
- **网络**: 需要连接互联网（调用OCR API）

---

## 更新日志

### V3.0 GUI (2026-01-07)

**新增功能：**
- ✨ 图形界面
- 🎨 现代化UI设计
- 📁 文件夹浏览功能
- ⚙️ 可视化列配置
- 📊 实时进度显示
- 📝 详细日志输出
- 🔔 弹窗提示和确认

**改进：**
- 用户体验优化
- 错误提示更友好
- 支持后台处理
- UI响应更流畅

---

## 技术支持

如有问题或建议，请查看：
- `conversion_log.txt` - 详细日志
- `README_V3.md` - 命令行版本说明
- `README_V2.md` - V2.0版本说明

---

## 下一步计划

- [ ] 支持拖放文件夹
- [ ] 批量处理进度预估
- [ ] 处理结果统计图表
- [ ] 历史记录功能
- [ ] 导出配置文件
- [ ] 多语言支持
